<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>JavaScript Async Programming - Callbacks, Promises v√† Async/Await | My Programming Blog</title><meta name=keywords content="javascript,async,promises,async-await,callbacks"><meta name=description content="H∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ l·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô trong JavaScript t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao"><meta name=author content="Thanh Tai"><link rel=canonical href=https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/javascript-async-programming/><link crossorigin=anonymous href=/my-programming-blog/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as=style><link rel=icon href=https://nguyenthanhluan09060024.github.io/my-programming-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nguyenthanhluan09060024.github.io/my-programming-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nguyenthanhluan09060024.github.io/my-programming-blog/favicon-32x32.png><link rel=apple-touch-icon href=https://nguyenthanhluan09060024.github.io/my-programming-blog/apple-touch-icon.png><link rel=mask-icon href=https://nguyenthanhluan09060024.github.io/my-programming-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/javascript-async-programming/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/javascript-async-programming/"><meta property="og:site_name" content="My Programming Blog"><meta property="og:title" content="JavaScript Async Programming - Callbacks, Promises v√† Async/Await"><meta property="og:description" content="H∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ l·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô trong JavaScript t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao"><meta property="og:locale" content="vi"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-06T12:00:00+07:00"><meta property="article:modified_time" content="2024-01-06T12:00:00+07:00"><meta property="article:tag" content="Javascript"><meta property="article:tag" content="Async"><meta property="article:tag" content="Promises"><meta property="article:tag" content="Async-Await"><meta property="article:tag" content="Callbacks"><meta name=twitter:card content="summary"><meta name=twitter:title content="JavaScript Async Programming - Callbacks, Promises v√† Async/Await"><meta name=twitter:description content="H∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ l·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô trong JavaScript t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/"},{"@type":"ListItem","position":2,"name":"JavaScript Async Programming - Callbacks, Promises v√† Async/Await","item":"https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/javascript-async-programming/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"JavaScript Async Programming - Callbacks, Promises v√† Async/Await","name":"JavaScript Async Programming - Callbacks, Promises v√† Async\/Await","description":"H∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ l·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô trong JavaScript t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao","keywords":["javascript","async","promises","async-await","callbacks"],"articleBody":"JavaScript Async Programming - Callbacks, Promises v√† Async/Await L·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô (asynchronous programming) l√† m·ªôt kh√°i ni·ªám quan tr·ªçng trong JavaScript. Trong b√†i vi·∫øt n√†y, t√¥i s·∫Ω h∆∞·ªõng d·∫´n b·∫°n t·ª´ Callbacks ƒë·∫øn Promises v√† Async/Await.\nT·∫°i Sao C·∫ßn Async Programming? JavaScript l√† single-threaded, nghƒ©a l√† ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán m·ªôt t√°c v·ª• t·∫°i m·ªôt th·ªùi ƒëi·ªÉm. ƒê·ªÉ x·ª≠ l√Ω c√°c t√°c v·ª• m·∫•t th·ªùi gian (nh∆∞ g·ªçi API, ƒë·ªçc file), ch√∫ng ta c·∫ßn async programming ƒë·ªÉ kh√¥ng block UI.\nCallbacks 1. Callback C∆° B·∫£n 1 2 3 4 5 6 7 8 9 10 11 12 function fetchData(callback) { setTimeout(() =\u003e { const data = { name: 'John', age: 30 }; callback(data); }, 1000); } function displayData(data) { console.log('Data received:', data); } fetchData(displayData); 2. Callback Hell 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ‚ùå Callback Hell - Kh√≥ ƒë·ªçc v√† maintain getUser(1, (user) =\u003e { console.log('User:', user); getPosts(user.id, (posts) =\u003e { console.log('Posts:', posts); getComments(posts[0].id, (comments) =\u003e { console.log('Comments:', comments); // Nested callbacks... }); }); }); 3. Error Handling v·ªõi Callbacks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function fetchData(successCallback, errorCallback) { setTimeout(() =\u003e { const random = Math.random(); if (random \u003e 0.5) { successCallback({ data: 'Success!' }); } else { errorCallback(new Error('Something went wrong!')); } }, 1000); } fetchData( (data) =\u003e console.log('Success:', data), (error) =\u003e console.error('Error:', error.message) ); Promises 1. T·∫°o Promise 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function fetchData() { return new Promise((resolve, reject) =\u003e { setTimeout(() =\u003e { const random = Math.random(); if (random \u003e 0.5) { resolve({ data: 'Success!' }); } else { reject(new Error('Something went wrong!')); } }, 1000); }); } // S·ª≠ d·ª•ng Promise fetchData() .then(data =\u003e console.log('Success:', data)) .catch(error =\u003e console.error('Error:', error.message)); 2. Promise Chaining 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 function getUser(id) { return new Promise((resolve) =\u003e { setTimeout(() =\u003e { resolve({ id, name: 'John Doe', email: 'john@example.com' }); }, 500); }); } function getPosts(userId) { return new Promise((resolve) =\u003e { setTimeout(() =\u003e { resolve([ { id: 1, title: 'Post 1', userId }, { id: 2, title: 'Post 2', userId } ]); }, 500); }); } function getComments(postId) { return new Promise((resolve) =\u003e { setTimeout(() =\u003e { resolve([ { id: 1, text: 'Great post!', postId }, { id: 2, text: 'Thanks for sharing', postId } ]); }, 500); }); } // Promise chaining getUser(1) .then(user =\u003e { console.log('User:', user); return getPosts(user.id); }) .then(posts =\u003e { console.log('Posts:', posts); return getComments(posts[0].id); }) .then(comments =\u003e { console.log('Comments:', comments); }) .catch(error =\u003e { console.error('Error:', error); }); 3. Promise.all v√† Promise.allSettled 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Promise.all - T·∫•t c·∫£ ph·∫£i th√†nh c√¥ng Promise.all([ fetchData('/api/users'), fetchData('/api/posts'), fetchData('/api/comments') ]) .then(([users, posts, comments]) =\u003e { console.log('All data loaded:', { users, posts, comments }); }) .catch(error =\u003e { console.error('One or more requests failed:', error); }); // Promise.allSettled - Ch·ªù t·∫•t c·∫£ ho√†n th√†nh (th√†nh c√¥ng ho·∫∑c th·∫•t b·∫°i) Promise.allSettled([ fetchData('/api/users'), fetchData('/api/posts'), fetchData('/api/comments') ]) .then(results =\u003e { results.forEach((result, index) =\u003e { if (result.status === 'fulfilled') { console.log(`Request ${index} succeeded:`, result.value); } else { console.log(`Request ${index} failed:`, result.reason); } }); }); 4. Promise.race 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 function timeout(ms) { return new Promise((_, reject) =\u003e { setTimeout(() =\u003e reject(new Error('Timeout')), ms); }); } function fetchData() { return new Promise(resolve =\u003e { setTimeout(() =\u003e resolve({ data: 'Success!' }), 2000); }); } // L·∫•y k·∫øt qu·∫£ c·ªßa promise n√†o ho√†n th√†nh tr∆∞·ªõc Promise.race([ fetchData(), timeout(3000) ]) .then(data =\u003e console.log('Data received:', data)) .catch(error =\u003e console.error('Error:', error.message)); Async/Await 1. C√∫ ph√°p C∆° B·∫£n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 async function fetchData() { try { const response = await fetch('/api/data'); const data = await response.json(); return data; } catch (error) { console.error('Error fetching data:', error); throw error; } } // S·ª≠ d·ª•ng async function async function main() { try { const data = await fetchData(); console.log('Data:', data); } catch (error) { console.error('Error:', error); } } main(); 2. X·ª≠ L√Ω Nhi·ªÅu Async Operations 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 // Sequential - Tu·∫ßn t·ª± async function sequentialExample() { const user = await getUser(1); console.log('User:', user); const posts = await getPosts(user.id); console.log('Posts:', posts); const comments = await getComments(posts[0].id); console.log('Comments:', comments); } // Parallel - Song song async function parallelExample() { const [user, posts, comments] = await Promise.all([ getUser(1), getPosts(1), getComments(1) ]); console.log('All data:', { user, posts, comments }); } // Mixed - H·ªón h·ª£p async function mixedExample() { const user = await getUser(1); const [posts, comments] = await Promise.all([ getPosts(user.id), getComments(user.id) ]); console.log('User with posts and comments:', { user, posts, comments }); } 3. Error Handling 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 async function fetchDataWithRetry(url, maxRetries = 3) { for (let i = 0; i \u003c maxRetries; i++) { try { const response = await fetch(url); if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); } return await response.json(); } catch (error) { console.log(`Attempt ${i + 1} failed:`, error.message); if (i === maxRetries - 1) { throw new Error(`Failed after ${maxRetries} attempts`); } // Wait before retry await new Promise(resolve =\u003e setTimeout(resolve, 1000 * (i + 1))); } } } // S·ª≠ d·ª•ng fetchDataWithRetry('/api/data') .then(data =\u003e console.log('Success:', data)) .catch(error =\u003e console.error('Failed:', error.message)); Advanced Patterns 1. Async Generator 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 async function* fetchPages(url) { let page = 1; let hasMore = true; while (hasMore) { try { const response = await fetch(`${url}?page=${page}`); const data = await response.json(); yield data; hasMore = data.hasMore; page++; } catch (error) { console.error('Error fetching page:', error); break; } } } // S·ª≠ d·ª•ng async generator async function processAllPages() { for await (const page of fetchPages('/api/posts')) { console.log('Processing page:', page); // Process each page } } 2. Async Queue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 class AsyncQueue { constructor(concurrency = 1) { this.concurrency = concurrency; this.running = 0; this.queue = []; } async add(task) { return new Promise((resolve, reject) =\u003e { this.queue.push({ task, resolve, reject }); this.process(); }); } async process() { if (this.running \u003e= this.concurrency || this.queue.length === 0) { return; } this.running++; const { task, resolve, reject } = this.queue.shift(); try { const result = await task(); resolve(result); } catch (error) { reject(error); } finally { this.running--; this.process(); } } } // S·ª≠ d·ª•ng const queue = new AsyncQueue(2); // Max 2 concurrent tasks async function processTasks() { const tasks = Array.from({ length: 10 }, (_, i) =\u003e () =\u003e new Promise(resolve =\u003e { setTimeout(() =\u003e resolve(`Task ${i} completed`), Math.random() * 1000); }) ); const results = await Promise.all( tasks.map(task =\u003e queue.add(task)) ); console.log('All tasks completed:', results); } 3. Debounce v√† Throttle 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 // Debounce - Ch·ªâ th·ª±c hi·ªán sau khi d·ª´ng m·ªôt kho·∫£ng th·ªùi gian function debounce(func, delay) { let timeoutId; return function(...args) { clearTimeout(timeoutId); timeoutId = setTimeout(() =\u003e func.apply(this, args), delay); }; } // Throttle - Th·ª±c hi·ªán t·ªëi ƒëa m·ªôt l·∫ßn trong kho·∫£ng th·ªùi gian function throttle(func, delay) { let lastCall = 0; return function(...args) { const now = Date.now(); if (now - lastCall \u003e= delay) { lastCall = now; return func.apply(this, args); } }; } // S·ª≠ d·ª•ng const debouncedSearch = debounce(async (query) =\u003e { if (query.length \u003c 2) return; try { const results = await searchAPI(query); displayResults(results); } catch (error) { console.error('Search error:', error); } }, 300); const throttledScroll = throttle(() =\u003e { console.log('Scroll event'); }, 100); Best Practices 1. Lu√¥n S·ª≠ D·ª•ng try-catch 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // ‚ùå Kh√¥ng t·ªët async function badExample() { const data = await fetchData(); // C√≥ th·ªÉ throw error return data.process(); } // ‚úÖ T·ªët async function goodExample() { try { const data = await fetchData(); return data.process(); } catch (error) { console.error('Error processing data:', error); throw error; // Re-throw n·∫øu c·∫ßn } } 2. S·ª≠ D·ª•ng Promise.all Khi C√≥ Th·ªÉ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // ‚ùå Sequential - Ch·∫≠m async function slowExample() { const user = await getUser(1); const posts = await getPosts(1); const comments = await getComments(1); return { user, posts, comments }; } // ‚úÖ Parallel - Nhanh async function fastExample() { const [user, posts, comments] = await Promise.all([ getUser(1), getPosts(1), getComments(1) ]); return { user, posts, comments }; } 3. X·ª≠ L√Ω Timeout 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 function withTimeout(promise, timeoutMs) { const timeoutPromise = new Promise((_, reject) =\u003e { setTimeout(() =\u003e reject(new Error('Timeout')), timeoutMs); }); return Promise.race([promise, timeoutPromise]); } // S·ª≠ d·ª•ng async function fetchDataWithTimeout() { try { const data = await withTimeout(fetchData(), 5000); return data; } catch (error) { if (error.message === 'Timeout') { console.error('Request timed out'); } else { console.error('Other error:', error); } throw error; } } K·∫øt Lu·∫≠n Async programming trong JavaScript ƒë√£ ph√°t tri·ªÉn t·ª´ Callbacks ‚Üí Promises ‚Üí Async/Await. M·ªói approach c√≥ ∆∞u nh∆∞·ª£c ƒëi·ªÉm ri√™ng:\nCallbacks: C∆° b·∫£n nh∆∞ng d·ªÖ t·∫°o callback hell Promises: T·ªët h∆°n callbacks, h·ªó tr·ª£ chaining Async/Await: D·ªÖ ƒë·ªçc nh·∫•t, gi·ªëng synchronous code V·ªõi nh·ªØng ki·∫øn th·ª©c n√†y, b·∫°n c√≥ th·ªÉ:\nX·ª≠ l√Ω c√°c t√°c v·ª• b·∫•t ƒë·ªìng b·ªô hi·ªáu qu·∫£ Tr√°nh callback hell S·ª≠ d·ª•ng async/await m·ªôt c√°ch ch√≠nh x√°c Implement c√°c pattern n√¢ng cao Trong b√†i vi·∫øt ti·∫øp theo, t√¥i s·∫Ω h∆∞·ªõng d·∫´n v·ªÅ testing trong JavaScript! üöÄ\n","wordCount":"1792","inLanguage":"en","datePublished":"2024-01-06T12:00:00+07:00","dateModified":"2024-01-06T12:00:00+07:00","author":{"@type":"Person","name":"Thanh Tai"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/javascript-async-programming/"},"publisher":{"@type":"Organization","name":"My Programming Blog","logo":{"@type":"ImageObject","url":"https://nguyenthanhluan09060024.github.io/my-programming-blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/ accesskey=h title="My Programming Blog (Alt + H)">My Programming Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/ title="üè† Trang ch·ªß"><span>üè† Trang ch·ªß</span></a></li><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/ title="üìù B√†i vi·∫øt"><span>üìù B√†i vi·∫øt</span></a></li><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/about/ title="üëã Gi·ªõi thi·ªáu"><span>üëã Gi·ªõi thi·ªáu</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/>Home</a>&nbsp;¬ª&nbsp;<a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">JavaScript Async Programming - Callbacks, Promises v√† Async/Await</h1><div class=post-description>H∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ l·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô trong JavaScript t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao</div><div class=post-meta></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#t·∫°i-sao-c·∫ßn-async-programming>T·∫°i Sao C·∫ßn Async Programming?</a></li><li><a href=#callbacks>Callbacks</a><ul><li><a href=#1-callback-c∆°-b·∫£n>1. Callback C∆° B·∫£n</a></li><li><a href=#2-callback-hell>2. Callback Hell</a></li><li><a href=#3-error-handling-v·ªõi-callbacks>3. Error Handling v·ªõi Callbacks</a></li></ul></li><li><a href=#promises>Promises</a><ul><li><a href=#1-t·∫°o-promise>1. T·∫°o Promise</a></li><li><a href=#2-promise-chaining>2. Promise Chaining</a></li><li><a href=#3-promiseall-v√†-promiseallsettled>3. Promise.all v√† Promise.allSettled</a></li><li><a href=#4-promiserace>4. Promise.race</a></li></ul></li><li><a href=#asyncawait>Async/Await</a><ul><li><a href=#1-c√∫-ph√°p-c∆°-b·∫£n>1. C√∫ ph√°p C∆° B·∫£n</a></li><li><a href=#2-x·ª≠-l√Ω-nhi·ªÅu-async-operations>2. X·ª≠ L√Ω Nhi·ªÅu Async Operations</a></li><li><a href=#3-error-handling>3. Error Handling</a></li></ul></li><li><a href=#advanced-patterns>Advanced Patterns</a><ul><li><a href=#1-async-generator>1. Async Generator</a></li><li><a href=#2-async-queue>2. Async Queue</a></li><li><a href=#3-debounce-v√†-throttle>3. Debounce v√† Throttle</a></li></ul></li><li><a href=#best-practices>Best Practices</a><ul><li><a href=#1-lu√¥n-s·ª≠-d·ª•ng-try-catch>1. Lu√¥n S·ª≠ D·ª•ng try-catch</a></li><li><a href=#2-s·ª≠-d·ª•ng-promiseall-khi-c√≥-th·ªÉ>2. S·ª≠ D·ª•ng Promise.all Khi C√≥ Th·ªÉ</a></li><li><a href=#3-x·ª≠-l√Ω-timeout>3. X·ª≠ L√Ω Timeout</a></li></ul></li><li><a href=#k·∫øt-lu·∫≠n>K·∫øt Lu·∫≠n</a></li></ul></nav></div></details></div><div class=post-content><h1 id=javascript-async-programming---callbacks-promises-v√†-asyncawait>JavaScript Async Programming - Callbacks, Promises v√† Async/Await<a hidden class=anchor aria-hidden=true href=#javascript-async-programming---callbacks-promises-v√†-asyncawait>#</a></h1><p>L·∫≠p tr√¨nh b·∫•t ƒë·ªìng b·ªô (asynchronous programming) l√† m·ªôt kh√°i ni·ªám quan tr·ªçng trong JavaScript. Trong b√†i vi·∫øt n√†y, t√¥i s·∫Ω h∆∞·ªõng d·∫´n b·∫°n t·ª´ Callbacks ƒë·∫øn Promises v√† Async/Await.</p><h2 id=t·∫°i-sao-c·∫ßn-async-programming>T·∫°i Sao C·∫ßn Async Programming?<a hidden class=anchor aria-hidden=true href=#t·∫°i-sao-c·∫ßn-async-programming>#</a></h2><p>JavaScript l√† single-threaded, nghƒ©a l√† ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán m·ªôt t√°c v·ª• t·∫°i m·ªôt th·ªùi ƒëi·ªÉm. ƒê·ªÉ x·ª≠ l√Ω c√°c t√°c v·ª• m·∫•t th·ªùi gian (nh∆∞ g·ªçi API, ƒë·ªçc file), ch√∫ng ta c·∫ßn async programming ƒë·ªÉ kh√¥ng block UI.</p><h2 id=callbacks>Callbacks<a hidden class=anchor aria-hidden=true href=#callbacks>#</a></h2><h3 id=1-callback-c∆°-b·∫£n>1. Callback C∆° B·∫£n<a hidden class=anchor aria-hidden=true href=#1-callback-c∆°-b·∫£n>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>fetchData</span><span class=p>(</span><span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;John&#39;</span><span class=p>,</span> <span class=nx>age</span><span class=o>:</span> <span class=mi>30</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=nx>callback</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>displayData</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Data received:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>fetchData</span><span class=p>(</span><span class=nx>displayData</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-callback-hell>2. Callback Hell<a hidden class=anchor aria-hidden=true href=#2-callback-hell>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// ‚ùå Callback Hell - Kh√≥ ƒë·ªçc v√† maintain
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=p>(</span><span class=nx>user</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;User:&#39;</span><span class=p>,</span> <span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>getPosts</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=p>(</span><span class=nx>posts</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Posts:&#39;</span><span class=p>,</span> <span class=nx>posts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>getComments</span><span class=p>(</span><span class=nx>posts</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>id</span><span class=p>,</span> <span class=p>(</span><span class=nx>comments</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Comments:&#39;</span><span class=p>,</span> <span class=nx>comments</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Nested callbacks...
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-error-handling-v·ªõi-callbacks>3. Error Handling v·ªõi Callbacks<a hidden class=anchor aria-hidden=true href=#3-error-handling-v·ªõi-callbacks>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>fetchData</span><span class=p>(</span><span class=nx>successCallback</span><span class=p>,</span> <span class=nx>errorCallback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>random</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>random</span> <span class=o>&gt;</span> <span class=mf>0.5</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>successCallback</span><span class=p>({</span> <span class=nx>data</span><span class=o>:</span> <span class=s1>&#39;Success!&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>errorCallback</span><span class=p>(</span><span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Something went wrong!&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>fetchData</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Success:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=promises>Promises<a hidden class=anchor aria-hidden=true href=#promises>#</a></h2><h3 id=1-t·∫°o-promise>1. T·∫°o Promise<a hidden class=anchor aria-hidden=true href=#1-t·∫°o-promise>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>fetchData</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>random</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>random</span> <span class=o>&gt;</span> <span class=mf>0.5</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>resolve</span><span class=p>({</span> <span class=nx>data</span><span class=o>:</span> <span class=s1>&#39;Success!&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>reject</span><span class=p>(</span><span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Something went wrong!&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng Promise
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fetchData</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>data</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Success:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-promise-chaining>2. Promise Chaining<a hidden class=anchor aria-hidden=true href=#2-promise-chaining>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getUser</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>resolve</span><span class=p>({</span> <span class=nx>id</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;John Doe&#39;</span><span class=p>,</span> <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;john@example.com&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getPosts</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>resolve</span><span class=p>([</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;Post 1&#39;</span><span class=p>,</span> <span class=nx>userId</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;Post 2&#39;</span><span class=p>,</span> <span class=nx>userId</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getComments</span><span class=p>(</span><span class=nx>postId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>resolve</span><span class=p>([</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>text</span><span class=o>:</span> <span class=s1>&#39;Great post!&#39;</span><span class=p>,</span> <span class=nx>postId</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>text</span><span class=o>:</span> <span class=s1>&#39;Thanks for sharing&#39;</span><span class=p>,</span> <span class=nx>postId</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Promise chaining
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>user</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;User:&#39;</span><span class=p>,</span> <span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>getPosts</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>posts</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Posts:&#39;</span><span class=p>,</span> <span class=nx>posts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>getComments</span><span class=p>(</span><span class=nx>posts</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>comments</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Comments:&#39;</span><span class=p>,</span> <span class=nx>comments</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-promiseall-v√†-promiseallsettled>3. Promise.all v√† Promise.allSettled<a hidden class=anchor aria-hidden=true href=#3-promiseall-v√†-promiseallsettled>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Promise.all - T·∫•t c·∫£ ph·∫£i th√†nh c√¥ng
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(</span><span class=s1>&#39;/api/users&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(</span><span class=s1>&#39;/api/posts&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(</span><span class=s1>&#39;/api/comments&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>then</span><span class=p>(([</span><span class=nx>users</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span><span class=p>])</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;All data loaded:&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>users</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;One or more requests failed:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Promise.allSettled - Ch·ªù t·∫•t c·∫£ ho√†n th√†nh (th√†nh c√¥ng ho·∫∑c th·∫•t b·∫°i)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>Promise</span><span class=p>.</span><span class=nx>allSettled</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(</span><span class=s1>&#39;/api/users&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(</span><span class=s1>&#39;/api/posts&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(</span><span class=s1>&#39;/api/comments&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>results</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>results</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>result</span><span class=p>,</span> <span class=nx>index</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>result</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=s1>&#39;fulfilled&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Request </span><span class=si>${</span><span class=nx>index</span><span class=si>}</span><span class=sb> succeeded:`</span><span class=p>,</span> <span class=nx>result</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Request </span><span class=si>${</span><span class=nx>index</span><span class=si>}</span><span class=sb> failed:`</span><span class=p>,</span> <span class=nx>result</span><span class=p>.</span><span class=nx>reason</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-promiserace>4. Promise.race<a hidden class=anchor aria-hidden=true href=#4-promiserace>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>timeout</span><span class=p>(</span><span class=nx>ms</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>_</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>reject</span><span class=p>(</span><span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Timeout&#39;</span><span class=p>)),</span> <span class=nx>ms</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>fetchData</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>resolve</span><span class=p>({</span> <span class=nx>data</span><span class=o>:</span> <span class=s1>&#39;Success!&#39;</span> <span class=p>}),</span> <span class=mi>2000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// L·∫•y k·∫øt qu·∫£ c·ªßa promise n√†o ho√†n th√†nh tr∆∞·ªõc
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>Promise</span><span class=p>.</span><span class=nx>race</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetchData</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>timeout</span><span class=p>(</span><span class=mi>3000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>data</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Data received:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=asyncawait>Async/Await<a hidden class=anchor aria-hidden=true href=#asyncawait>#</a></h2><h3 id=1-c√∫-ph√°p-c∆°-b·∫£n>1. C√∫ ph√°p C∆° B·∫£n<a hidden class=anchor aria-hidden=true href=#1-c√∫-ph√°p-c∆°-b·∫£n>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fetchData</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/api/data&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching data:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng async function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Data:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-x·ª≠-l√Ω-nhi·ªÅu-async-operations>2. X·ª≠ L√Ω Nhi·ªÅu Async Operations<a hidden class=anchor aria-hidden=true href=#2-x·ª≠-l√Ω-nhi·ªÅu-async-operations>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Sequential - Tu·∫ßn t·ª±
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>sequentialExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;User:&#39;</span><span class=p>,</span> <span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>posts</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getPosts</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Posts:&#39;</span><span class=p>,</span> <span class=nx>posts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>comments</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getComments</span><span class=p>(</span><span class=nx>posts</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Comments:&#39;</span><span class=p>,</span> <span class=nx>comments</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Parallel - Song song
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>parallelExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>user</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span><span class=p>]</span> <span class=o>=</span> <span class=kr>await</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>getPosts</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>getComments</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;All data:&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>user</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Mixed - H·ªón h·ª£p
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>mixedExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span><span class=p>]</span> <span class=o>=</span> <span class=kr>await</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=nx>getPosts</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>getComments</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;User with posts and comments:&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>user</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-error-handling>3. Error Handling<a hidden class=anchor aria-hidden=true href=#3-error-handling>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fetchDataWithRetry</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>maxRetries</span> <span class=o>=</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>maxRetries</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`HTTP error! status: </span><span class=si>${</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Attempt </span><span class=si>${</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=sb> failed:`</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>i</span> <span class=o>===</span> <span class=nx>maxRetries</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`Failed after </span><span class=si>${</span><span class=nx>maxRetries</span><span class=si>}</span><span class=sb> attempts`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// Wait before retry
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=mi>1000</span> <span class=o>*</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>fetchDataWithRetry</span><span class=p>(</span><span class=s1>&#39;/api/data&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>data</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Success:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Failed:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=advanced-patterns>Advanced Patterns<a hidden class=anchor aria-hidden=true href=#advanced-patterns>#</a></h2><h3 id=1-async-generator>1. Async Generator<a hidden class=anchor aria-hidden=true href=#1-async-generator>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span><span class=o>*</span> <span class=nx>fetchPages</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>page</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>hasMore</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=nx>hasMore</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>url</span><span class=si>}</span><span class=sb>?page=</span><span class=si>${</span><span class=nx>page</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>yield</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nx>hasMore</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>hasMore</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>page</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching page:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng async generator
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>processAllPages</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=kr>await</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>page</span> <span class=k>of</span> <span class=nx>fetchPages</span><span class=p>(</span><span class=s1>&#39;/api/posts&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Processing page:&#39;</span><span class=p>,</span> <span class=nx>page</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Process each page
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-async-queue>2. Async Queue<a hidden class=anchor aria-hidden=true href=#2-async-queue>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>AsyncQueue</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>concurrency</span> <span class=o>=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>concurrency</span> <span class=o>=</span> <span class=nx>concurrency</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>running</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>queue</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>add</span><span class=p>(</span><span class=nx>task</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>queue</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>task</span><span class=p>,</span> <span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>process</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>process</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>running</span> <span class=o>&gt;=</span> <span class=k>this</span><span class=p>.</span><span class=nx>concurrency</span> <span class=o>||</span> <span class=k>this</span><span class=p>.</span><span class=nx>queue</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>running</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=p>{</span> <span class=nx>task</span><span class=p>,</span> <span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>queue</span><span class=p>.</span><span class=nx>shift</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>task</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>resolve</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>reject</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>running</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>process</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>AsyncQueue</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span> <span class=c1>// Max 2 concurrent tasks
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>processTasks</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>.</span><span class=nx>from</span><span class=p>({</span> <span class=nx>length</span><span class=o>:</span> <span class=mi>10</span> <span class=p>},</span> <span class=p>(</span><span class=nx>_</span><span class=p>,</span> <span class=nx>i</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>()</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>resolve</span><span class=p>(</span><span class=sb>`Task </span><span class=si>${</span><span class=nx>i</span><span class=si>}</span><span class=sb> completed`</span><span class=p>),</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>results</span> <span class=o>=</span> <span class=kr>await</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>tasks</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>task</span> <span class=p>=&gt;</span> <span class=nx>queue</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>task</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;All tasks completed:&#39;</span><span class=p>,</span> <span class=nx>results</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-debounce-v√†-throttle>3. Debounce v√† Throttle<a hidden class=anchor aria-hidden=true href=#3-debounce-v√†-throttle>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Debounce - Ch·ªâ th·ª±c hi·ªán sau khi d·ª´ng m·ªôt kho·∫£ng th·ªùi gian
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>debounce</span><span class=p>(</span><span class=nx>func</span><span class=p>,</span> <span class=nx>delay</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>timeoutId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kd>function</span><span class=p>(...</span><span class=nx>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>clearTimeout</span><span class=p>(</span><span class=nx>timeoutId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>timeoutId</span> <span class=o>=</span> <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>func</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>args</span><span class=p>),</span> <span class=nx>delay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Throttle - Th·ª±c hi·ªán t·ªëi ƒëa m·ªôt l·∫ßn trong kho·∫£ng th·ªùi gian
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>throttle</span><span class=p>(</span><span class=nx>func</span><span class=p>,</span> <span class=nx>delay</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>lastCall</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kd>function</span><span class=p>(...</span><span class=nx>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>now</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>now</span> <span class=o>-</span> <span class=nx>lastCall</span> <span class=o>&gt;=</span> <span class=nx>delay</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>lastCall</span> <span class=o>=</span> <span class=nx>now</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>func</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>args</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>debouncedSearch</span> <span class=o>=</span> <span class=nx>debounce</span><span class=p>(</span><span class=kr>async</span> <span class=p>(</span><span class=nx>query</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>query</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>results</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>searchAPI</span><span class=p>(</span><span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>displayResults</span><span class=p>(</span><span class=nx>results</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Search error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=mi>300</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>throttledScroll</span> <span class=o>=</span> <span class=nx>throttle</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Scroll event&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=mi>100</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=best-practices>Best Practices<a hidden class=anchor aria-hidden=true href=#best-practices>#</a></h2><h3 id=1-lu√¥n-s·ª≠-d·ª•ng-try-catch>1. Lu√¥n S·ª≠ D·ª•ng try-catch<a hidden class=anchor aria-hidden=true href=#1-lu√¥n-s·ª≠-d·ª•ng-try-catch>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// ‚ùå Kh√¥ng t·ªët
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>badExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchData</span><span class=p>();</span> <span class=c1>// C√≥ th·ªÉ throw error
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>data</span><span class=p>.</span><span class=nx>process</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ‚úÖ T·ªët
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>goodExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>data</span><span class=p>.</span><span class=nx>process</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error processing data:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span> <span class=c1>// Re-throw n·∫øu c·∫ßn
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-s·ª≠-d·ª•ng-promiseall-khi-c√≥-th·ªÉ>2. S·ª≠ D·ª•ng Promise.all Khi C√≥ Th·ªÉ<a hidden class=anchor aria-hidden=true href=#2-s·ª≠-d·ª•ng-promiseall-khi-c√≥-th·ªÉ>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// ‚ùå Sequential - Ch·∫≠m
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>slowExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>posts</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getPosts</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>comments</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getComments</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>user</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ‚úÖ Parallel - Nhanh
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fastExample</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>user</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span><span class=p>]</span> <span class=o>=</span> <span class=kr>await</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=nx>getUser</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>getPosts</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>getComments</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>user</span><span class=p>,</span> <span class=nx>posts</span><span class=p>,</span> <span class=nx>comments</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-x·ª≠-l√Ω-timeout>3. X·ª≠ L√Ω Timeout<a hidden class=anchor aria-hidden=true href=#3-x·ª≠-l√Ω-timeout>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>withTimeout</span><span class=p>(</span><span class=nx>promise</span><span class=p>,</span> <span class=nx>timeoutMs</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>timeoutPromise</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>_</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>reject</span><span class=p>(</span><span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Timeout&#39;</span><span class=p>)),</span> <span class=nx>timeoutMs</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>race</span><span class=p>([</span><span class=nx>promise</span><span class=p>,</span> <span class=nx>timeoutPromise</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// S·ª≠ d·ª•ng
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fetchDataWithTimeout</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>withTimeout</span><span class=p>(</span><span class=nx>fetchData</span><span class=p>(),</span> <span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>message</span> <span class=o>===</span> <span class=s1>&#39;Timeout&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Request timed out&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Other error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=k·∫øt-lu·∫≠n>K·∫øt Lu·∫≠n<a hidden class=anchor aria-hidden=true href=#k·∫øt-lu·∫≠n>#</a></h2><p>Async programming trong JavaScript ƒë√£ ph√°t tri·ªÉn t·ª´ Callbacks ‚Üí Promises ‚Üí Async/Await. M·ªói approach c√≥ ∆∞u nh∆∞·ª£c ƒëi·ªÉm ri√™ng:</p><ul><li><strong>Callbacks</strong>: C∆° b·∫£n nh∆∞ng d·ªÖ t·∫°o callback hell</li><li><strong>Promises</strong>: T·ªët h∆°n callbacks, h·ªó tr·ª£ chaining</li><li><strong>Async/Await</strong>: D·ªÖ ƒë·ªçc nh·∫•t, gi·ªëng synchronous code</li></ul><p>V·ªõi nh·ªØng ki·∫øn th·ª©c n√†y, b·∫°n c√≥ th·ªÉ:</p><ul><li>X·ª≠ l√Ω c√°c t√°c v·ª• b·∫•t ƒë·ªìng b·ªô hi·ªáu qu·∫£</li><li>Tr√°nh callback hell</li><li>S·ª≠ d·ª•ng async/await m·ªôt c√°ch ch√≠nh x√°c</li><li>Implement c√°c pattern n√¢ng cao</li></ul><p>Trong b√†i vi·∫øt ti·∫øp theo, t√¥i s·∫Ω h∆∞·ªõng d·∫´n v·ªÅ testing trong JavaScript! üöÄ</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/tags/javascript/>Javascript</a></li><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/tags/async/>Async</a></li><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/tags/promises/>Promises</a></li><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/tags/async-await/>Async-Await</a></li><li><a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/tags/callbacks/>Callbacks</a></li></ul><nav class=paginav><a class=prev href=https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/java-spring-data-jpa/><span class=title>¬´ Prev</span><br><span>Spring Data JPA - L√†m Vi·ªác V·ªõi Database Hi·ªáu Qu·∫£</span>
</a><a class=next href=https://nguyenthanhluan09060024.github.io/my-programming-blog/posts/react-hooks-guide/><span class=title>Next ¬ª</span><br><span>H∆∞·ªõng D·∫´n React Hooks Cho Ng∆∞·ªùi M·ªõi B·∫Øt ƒê·∫ßu</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://nguyenthanhluan09060024.github.io/my-programming-blog/>My Programming Blog</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>